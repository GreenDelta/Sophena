<?xml version="1.0" encoding="UTF-8"?>
<project name="project" default="package">

	<property file="build.properties" />

	<target name="package">
		<antcall target="winzip">
			<param name="win" value="win64" />
			<param name="suffix" value="win32.x86_64" />
		</antcall>
		<antcall target="winzip">
			<param name="win" value="win32" />
			<param name="suffix" value="win32.x86" />
		</antcall>
	</target>


	<target name="winzip">
		<copy tofile="${basedir}/packages/temp_${suffix}.zip">
			<fileset dir="${basedir}/builds" includes="*${suffix}.zip" />
		</copy>
		<exec executable="${basedir}/tools/7za.exe">
			<arg value="x" />
			<arg value="${basedir}/packages/temp_${suffix}.zip" />
			<arg value="-o${basedir}/packages/temp_${suffix}" />
		</exec>
		<copy todir="${basedir}/packages/temp_${suffix}/Sophena/jre">
			<fileset dir="${basedir}/runtime/${win}/jre" />
		</copy>
		<exec executable="${basedir}/tools/7za.exe">
			<arg value="a" />
			<arg value="${basedir}/packages/Sophena_${sophena_version}_${win}.zip" />
			<arg value="${basedir}/packages/temp_${suffix}/Sophena" />
		</exec>
		<delete dir="${basedir}/packages/temp_${suffix}" />
		<delete file="${basedir}/packages/temp_${suffix}.zip" />
	</target>


</project>
